<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

<meta property="og:title" content="Common Design Patterns" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://docs.jina.ai/chapters/flow/pattern/" />
  
<meta property="og:site_name" content="Jina 0.8.17 Documentation" />
  
<meta property="og:description" content="Jina is a really flexible AI-powered neural search framework and is designed to enable any pattern that can be framed as a neural search problem. However, there are basic common patterns that show up when developing search solutions with Jina: CompoundIndexer (Vector + KV Indexers): For neural se..." />
  
<meta property="og:image" content="https://docs.jina.ai/_static/banner.png" />
  
<meta property="og:image:alt" content="Jina 0.8.17 Documentation" />
  
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description" content="Build cross-modal and multi-modal applications on the cloud ¬∑ Neural Search ¬∑ Creative AI ¬∑ Cloud Native ¬∑ MLOps">
<meta property="og:description" content="Build cross-modal and multi-modal applications on the cloud ¬∑ Neural Search ¬∑ Creative AI ¬∑ Cloud Native ¬∑ MLOps">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-48ZDWC8GT6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-48ZDWC8GT6');
</script>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" /><link rel="search" title="Search" href="../../../search/" /><link rel="next" title="Multi &amp; Cross Modality" href="../../cross-multi-modality/" /><link rel="prev" title="Understand Jina Recursive Document Representation" href="../../traversal/" />
        <link rel="canonical" href="https://docs.jina.ai/chapters/flow/pattern.html" />

    <link rel="shortcut icon" href="../../../_static/favicon.ico"/><meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Common Design Patterns - Jina 3.10.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/docbot.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: #4d4d4d;
  --color-brand-primary: #009191;
  --color-brand-content: #009191;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../../../">
                <div class="brand">Jina 3.10.2 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">
            
            <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo-light.svg" alt="Light Logo" />
    <img class="sidebar-logo only-dark" src="../../../_static/logo-dark.svg" alt="Dark Logo" />
  </div>
  
  
</a>
<div class="sd-d-flex-row sd-align-major-spaced">
  <a class="github-button" href="https://github.com/jina-ai/jina" data-icon="octicon-star" data-show-count="true" aria-label="Star jina-ai/jina on GitHub" style="opacity: 0;">Star</a>
  
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
    <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../install/os/">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/via-pip/">Install Jina via <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/via-pip/#upgrade-jina">Upgrade Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/via-docker/">Install Jina via Docker Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/on-rasp-linux/">Install Jina on Raspberry Pi and other Linux Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/on-wsl/">Install Jina on Windows Subsystem for Linux (WSL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/os/on-x/">Can I Run Jina On ‚Ä¶.?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/autocomplete/">Autocomplete commands on Bash, Zsh and Fish</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../helloworld/">Jina ‚ÄúHello, World!‚Äù üëãüåç</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../101/">Jina 101: First Thing to Learn About Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../">Using Flow API to Compose Your Jina Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/">Input and Output Functions in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli/exit/">Gracefully Exit Jina</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cli/">Jina Command-Line Interface</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-helloworld/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">hello-world</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-pod/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">pod</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-flow/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">flow</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-gateway/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">gateway</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-ping/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">ping</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-check/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">check</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-log/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-pea/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">pea</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/jina-client/"><code class="docutils literal notranslate"><span class="pre">jina</span> <span class="pre">client</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/jina/">Jina Python API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.clients/">jina.clients</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.clients.asyncio/">jina.clients.asyncio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.clients.base/">jina.clients.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.clients.helper/">jina.clients.helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.clients.request/">jina.clients.request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.clients.sugary_io/">jina.clients.sugary_io</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.docker/">jina.docker</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.docker.checker/">jina.docker.checker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.docker.helper/">jina.docker.helper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.docker.hubapi/">jina.docker.hubapi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.docker.hubio/">jina.docker.hubio</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.drivers/">jina.drivers</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.drivers.querylang/">jina.drivers.querylang</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.drivers.querylang.queryset/">jina.drivers.querylang.queryset</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.drivers.querylang.queryset.dunderkey/">jina.drivers.querylang.queryset.dunderkey</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.drivers.querylang.queryset.helper/">jina.drivers.querylang.queryset.helper</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.drivers.querylang.queryset.lookup/">jina.drivers.querylang.queryset.lookup</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.querylang.filter/">jina.drivers.querylang.filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.querylang.reverse/">jina.drivers.querylang.reverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.querylang.select/">jina.drivers.querylang.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.querylang.slice/">jina.drivers.querylang.slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.querylang.sort/">jina.drivers.querylang.sort</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.drivers.rank/">jina.drivers.rank</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.drivers.rank.aggregate/">jina.drivers.rank.aggregate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.cache/">jina.drivers.cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.control/">jina.drivers.control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.convert/">jina.drivers.convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.craft/">jina.drivers.craft</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.encode/">jina.drivers.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.evaluate/">jina.drivers.evaluate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.index/">jina.drivers.index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.multimodal/">jina.drivers.multimodal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.predict/">jina.drivers.predict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.reduce/">jina.drivers.reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.drivers.search/">jina.drivers.search</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.executors/">jina.executors</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.classifiers/">jina.executors.classifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.crafters/">jina.executors.crafters</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.executors.encoders/">jina.executors.encoders</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.encoders.multimodal/">jina.executors.encoders.multimodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.encoders.numeric/">jina.executors.encoders.numeric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.encoders.frameworks/">jina.executors.encoders.frameworks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.encoders.tfserving/">jina.executors.encoders.tfserving</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.executors.evaluators/">jina.executors.evaluators</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.executors.evaluators.embedding/">jina.executors.evaluators.embedding</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.executors.evaluators.embedding.cosine/">jina.executors.evaluators.embedding.cosine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.executors.evaluators.embedding.euclidean/">jina.executors.evaluators.embedding.euclidean</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.executors.evaluators.rank/">jina.executors.evaluators.rank</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.executors.evaluators.rank.precision/">jina.executors.evaluators.rank.precision</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.executors.evaluators.rank.recall/">jina.executors.evaluators.rank.recall</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.executors.evaluators.text/">jina.executors.evaluators.text</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.executors.evaluators.text.length/">jina.executors.evaluators.text.length</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.evaluators.running_stats/">jina.executors.evaluators.running_stats</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.executors.indexers/">jina.executors.indexers</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.indexers.cache/">jina.executors.indexers.cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.indexers.keyvalue/">jina.executors.indexers.keyvalue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.executors.indexers.vector/">jina.executors.indexers.vector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.rankers/">jina.executors.rankers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.clients/">jina.executors.clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.compound/">jina.executors.compound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.decorators/">jina.executors.decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.devices/">jina.executors.devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.metas/">jina.executors.metas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.executors.requests/">jina.executors.requests</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.flow/">jina.flow</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.flow.asyncio/">jina.flow.asyncio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.flow.base/">jina.flow.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.flow.builder/">jina.flow.builder</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.helloworld/">jina.helloworld</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.helloworld.components/">jina.helloworld.components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.helloworld.helper/">jina.helloworld.helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.jaml/">jina.jaml</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers/">jina.jaml.parsers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.driver/">jina.jaml.parsers.driver</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.jaml.parsers.driver.legacy/">jina.jaml.parsers.driver.legacy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.executor/">jina.jaml.parsers.executor</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.jaml.parsers.executor.legacy/">jina.jaml.parsers.executor.legacy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.flow/">jina.jaml.parsers.flow</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.jaml.parsers.flow.legacy/">jina.jaml.parsers.flow.legacy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.jaml.parsers.flow.v1/">jina.jaml.parsers.flow.v1</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.jaml.parsers.base/">jina.jaml.parsers.base</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.jaml.helper/">jina.jaml.helper</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.logging/">jina.logging</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.logging.formatter/">jina.logging.formatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.logging.logger/">jina.logging.logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.logging.pipe/">jina.logging.pipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.logging.profile/">jina.logging.profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.logging.sse/">jina.logging.sse</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.peapods/">jina.peapods</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.peapods.peas/">jina.peapods.peas</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.peapods.peas.gateway/">jina.peapods.peas.gateway</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.peapods.peas.gateway.grpc/">jina.peapods.peas.gateway.grpc</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.peapods.peas.gateway.grpc.async_call/">jina.peapods.peas.gateway.grpc.async_call</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.peapods.peas.gateway.rest/">jina.peapods.peas.gateway.rest</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.peapods.peas.headtail/">jina.peapods.peas.headtail</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.peapods.peas.headtail.head/">jina.peapods.peas.headtail.head</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.peapods.peas.headtail.tail/">jina.peapods.peas.headtail.tail</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.peapods.pods/">jina.peapods.pods</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.pods.flow/">jina.peapods.pods.flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.pods.gateway/">jina.peapods.pods.gateway</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.pods.helper/">jina.peapods.pods.helper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.pods.mutable/">jina.peapods.pods.mutable</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.peapods.runtimes/">jina.peapods.runtimes</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.runtimes.container/">jina.peapods.runtimes.container</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.peapods.runtimes.local/">jina.peapods.runtimes.local</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.peapods.runtimes.remote/">jina.peapods.runtimes.remote</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.peapods.runtimes.remote.jinad/">jina.peapods.runtimes.remote.jinad</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.peapods.runtimes.remote.jinad.api/">jina.peapods.runtimes.remote.jinad.api</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.peapods.runtimes.remote.ssh/">jina.peapods.runtimes.remote.ssh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.peapods.zmq/">jina.peapods.zmq</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.proto/">jina.proto</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.proto.jina_pb2/">jina.proto.jina_pb2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.proto.jina_pb2_grpc/">jina.proto.jina_pb2_grpc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.proto.serializer/">jina.proto.serializer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina.types/">jina.types</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types.document/">jina.types.document</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.document.converters/">jina.types.document.converters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.document.helper/">jina.types.document.helper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.document.multimodal/">jina.types.document.multimodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.document.uid/">jina.types.document.uid</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types.message/">jina.types.message</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.message.common/">jina.types.message.common</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types.ndarray/">jina.types.ndarray</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.types.ndarray.dense/">jina.types.ndarray.dense</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.ndarray.dense.numpy/">jina.types.ndarray.dense.numpy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.types.ndarray.sparse/">jina.types.ndarray.sparse</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.ndarray.sparse.numpy/">jina.types.ndarray.sparse.numpy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.ndarray.sparse.pytorch/">jina.types.ndarray.sparse.pytorch</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.ndarray.sparse.scipy/">jina.types.ndarray.sparse.scipy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.ndarray.sparse.tensorflow/">jina.types.ndarray.sparse.tensorflow</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.ndarray.generic/">jina.types.ndarray.generic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.types.querylang/">jina.types.querylang</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types.request/">jina.types.request</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.request.common/">jina.types.request.common</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.types.score/">jina.types.score</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types.sets/">jina.types.sets</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.sets.chunk/">jina.types.sets.chunk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.sets.document/">jina.types.sets.document</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.sets.match/">jina.types.sets.match</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.sets.querylang/">jina.types.sets.querylang</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.checker/">jina.checker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.enums/">jina.enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.excepts/">jina.excepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.helper/">jina.helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.importer/">jina.importer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jina.parser/">jina.parser</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../yaml/yaml/">Jina YAML Syntax Reference</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../proto/">Jina Protobuf Specification</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../proto/modify/">Update Protocol Specification</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Usages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../traversal/">Understand Jina Recursive Document Representation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Common Design Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross-multi-modality/">Multi &amp; Cross Modality</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hub/">Using Jina Pod with Docker Container</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hub/build-pod-image/">Build Your Pod into a Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hub/use-your-pod/">Use Your Pod Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hub/publish-your-pod-image/">Publish Your Pod Image to Jina Hub</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../remote/">Using Jina Pod Remotely</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../remote/run-remote-pod-console/">Creating a Remote Jina Pod from Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../remote/run-remote-pod-jina/">Creating a Remote Jina Pod via Jina Gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../remote/run-remote-pod-flow/">Creating a Remote Jina Pod via Flow API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../logging/">Logging configuration in jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard/">Using Dashboard to Monitor Logs and View Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../simple_exec/">Built-in Simple Executors and Reserved <code class="docutils literal notranslate"><span class="pre">uses</span></code> in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../restapi/">Jina REST API Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../envs/">OS Environment Variables Used in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prevent_duplicate_indexing/">Prevent Indexing Duplicates</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../extend/executor/">Guideline When Adding New Executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extend/mwu/">A Minimum Working Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extend/driver/">Guideline When Adding New Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hub/publish-your-pod-image/">Publish Your Pod Image to Jina Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_schema/">Jina API Schema for 3rd-Party Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/">Contributing to Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/#join-us-on-slack">Join Us on Slack!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RELEASE/">Release Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG/">Change Logs</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../jep/">Jina Enhancement Proposals (JEP)</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../jep/jep-1/">JEP 1 ‚Äî Redesigning <code class="docutils literal notranslate"><span class="pre">Driver</span></code> and its relation to <code class="docutils literal notranslate"><span class="pre">Executor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jep/jep-2/">JEP 2 ‚Äî Supporting Docker Container in Flow API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jep/jep-3/">JEP 3 ‚Äî Adding support for multi-fields search</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/dev/">FAQ for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/user/">FAQ for End-Users</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../all_exec/">List of 100 Executors in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../all_driver/">List of 60 Drivers in Jina</a></li>
</ul>

    <p class="caption" role="heading"><span class="caption-text">Ecosystem</span></p>
    <ul>
        <li class="toctree-l1">
            <a class="reference internal" href="#">
                <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/search-light.svg">
                <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/search-dark.svg">
                Jina</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://hub.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/hub-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/hub-dark.svg">
            Jina Hub</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://finetuner.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/finetuner-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/finetuner-dark.svg">
            Finetuner</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://docarray.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/docarray-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/docarray-dark.svg">
            DocArray</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://clip-as-service.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/cas-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/cas-dark.svg">
            CLIP-as-service</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/jcloud">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/JCloud-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/JCloud-dark.svg">
            JCloud</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://now.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/now-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/now-dark.svg">
            NOW</a></li>
    </ul>
</div>

</div>

            </div>
            
        </div>
    </aside>
    <div class="main">
        <div class="content">
            <div class="article-container">
                <a href="#" class="back-to-top muted-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
                    </svg>
                    <span>Back to top</span>
                </a>
                <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon"
                           for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <article role="main">
                    <section id="common-design-patterns">
<h1>Common Design Patterns<a class="headerlink" href="#common-design-patterns" title="Permalink to this heading">#</a></h1>
<p>Jina is a really flexible AI-powered neural search framework and is designed to enable any pattern that can be framed as a neural search problem. However, there are basic common patterns that show up when developing search solutions with Jina:</p>
<section id="compoundindexer-vector-kv-indexers">
<h2>CompoundIndexer (Vector + KV Indexers)<a class="headerlink" href="#compoundindexer-vector-kv-indexers" title="Permalink to this heading">#</a></h2>
<p>For neural search applications, it helps to use a <code class="docutils literal notranslate"><span class="pre">CompoundIndexer</span></code> in the same Pod for both the index and query Flows. The following YAML file shows an example of this pattern:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!CompoundIndexer</span><span class="w"></span>
<span class="nt">components</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!NumpyIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vectors.gz</span><span class="w"></span>
<span class="w">      </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cosine</span><span class="w"></span>
<span class="w">    </span><span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vecIndexer</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!BinaryPbIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">values.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kvIndexer</span><span class="w">  </span><span class="c1"># a customized name</span><span class="w"></span>
<span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">complete indexer</span><span class="w"></span>
</pre></div>
</div>
<p>The above YAML creates a Flow that:</p>
<ul class="simple">
<li><p>Acts as a single indexer</p></li>
<li><p>Lets you seamlessly query the index with the embedding vector from any upstream encoder</p></li>
<li><p>Returns the binary information in the key-value index in the Pod‚Äôs response message.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">VectorIndexer</span></code>:</p>
<ul class="simple">
<li><p>Retrieves the most relevant Documents by finding similarities in the embedding space</p></li>
<li><p>Uses the key-value index to extract meaningful data and fields from those Documents</p></li>
</ul>
</section>
<section id="text-document-segmentation">
<h2>Text Document Segmentation<a class="headerlink" href="#text-document-segmentation" title="Permalink to this heading">#</a></h2>
<p>A common search pattern is storing long text documents in an index to retrieve them later using short sentences. A single embedding vector per long text document is not the proper way to do this: It makes it hard to extract a single semantically-meaningful vector from a long document. Jina solves this by introducing <a class="reference external" href="https://github.com/jina-ai/jina/tree/master/docs/chapters/101#document--chunk">Chunks</a>. The common scenario is to have a <code class="docutils literal notranslate"><span class="pre">crafter</span></code> segmenting the document into smaller parts (typically short sentences) followed by an NLP-based encoder.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!Sentencizer</span><span class="w"></span>
<span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">min_sent_len</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<span class="w">  </span><span class="nt">max_sent_len</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!TransformerTorchEncoder</span><span class="w"></span>
<span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">pooling_strategy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auto</span><span class="w"></span>
<span class="w">  </span><span class="nt">pretrained_model_name_or_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distilbert-base-cased</span><span class="w"></span>
<span class="w">  </span><span class="nt">max_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">96</span><span class="w"></span>
</pre></div>
</div>
<p>This way a single document contains <code class="docutils literal notranslate"><span class="pre">N</span></code> different Chunks that are later independently encoded by a downstream encoder. This lets Jina query the index using a short sentence as input, where similarity search can be applied to find the most common Chunks. This way the same Document can be retrieved based on searching different parts of it.</p>
<p>For instance, a text document containing 3 sentences can be decomposed into 3 Chunks:</p>
<p><code class="docutils literal notranslate"><span class="pre">Someone</span> <span class="pre">is</span> <span class="pre">waiting</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">bus</span> <span class="pre">stop.</span> <span class="pre">John</span> <span class="pre">looks</span> <span class="pre">surprised,</span> <span class="pre">his</span> <span class="pre">face</span> <span class="pre">seems</span> <span class="pre">familiar</span></code> -&gt;
[<code class="docutils literal notranslate"><span class="pre">Someone</span> <span class="pre">is</span> <span class="pre">waiting</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">bus</span> <span class="pre">stop</span></code>, <code class="docutils literal notranslate"><span class="pre">John</span> <span class="pre">looks</span> <span class="pre">surprised</span></code>, <code class="docutils literal notranslate"><span class="pre">his</span> <span class="pre">face</span> <span class="pre">seems</span> <span class="pre">familiar</span></code>]</p>
<p>This lets us retrieve the Document from different <code class="docutils literal notranslate"><span class="pre">input</span></code> sentences that match any of these 3 parts. For instance, these 3 different inputs could lead to the extraction of the same document by targeting 3 different Chunks:</p>
<ul class="simple">
<li><p>A standing guy -&gt; Someone is waiting at the bus stop.</p></li>
<li><p>He is amazed` -&gt; John looks surprised.</p></li>
<li><p>a similar look -&gt; his face seems familiar.</p></li>
</ul>
</section>
<section id="indexers-at-different-depth-levels">
<h2>Indexers at Different Depth Levels<a class="headerlink" href="#indexers-at-different-depth-levels" title="Permalink to this heading">#</a></h2>
<p>In a configuration like the one for <em>Text Document Segmentation</em>, we need different levels of indexing. The system needs to keep the data related to the Chunks as well as the information of the original documents. This way:</p>
<ol class="arabic simple">
<li><p>The actual search is performed at the Chunk level following the <code class="docutils literal notranslate"><span class="pre">CompoundIndexer</span></code> pattern.</p></li>
<li><p>Then the Document indexer works as a final step to extract the actual Documents expected by the user.</p></li>
</ol>
<p>To implement this, two common structures appear in <code class="docutils literal notranslate"><span class="pre">index</span></code> and <code class="docutils literal notranslate"><span class="pre">query</span></code>. In an <code class="docutils literal notranslate"><span class="pre">index</span></code> flow, these two indexers work in parallel:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">chunk</span> <span class="pre">indexer</span></code> gets messages from an <code class="docutils literal notranslate"><span class="pre">encoder</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">doc</span> <span class="pre">indexer</span></code> can get the documents even from the <code class="docutils literal notranslate"><span class="pre">gateway</span></code>.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!Flow</span><span class="w"></span>
<span class="nt">pods</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">encoder</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BaseEncoder</span><span class="w"></span>
<span class="w">  </span><span class="nt">chunk_indexer</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CompoundIndexer</span><span class="w"></span>
<span class="w">  </span><span class="nt">doc_indexer</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BinaryPbIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway</span><span class="w"></span>
<span class="w">  </span><span class="nt">join_all</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_pass</span><span class="w"></span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">doc_indexer</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">chunk_indexer</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
<p>However, at query time the Document and Chunk indexers work sequentially. Normally the Document would get messages from the Chunk indexer with a <code class="docutils literal notranslate"><span class="pre">Chunk2DocRanker</span></code> Pod in the middle of the Flow. The <code class="docutils literal notranslate"><span class="pre">ranker</span></code> would rank the Chunks by relevance and reduce the results to the parent IDs, enabling the <code class="docutils literal notranslate"><span class="pre">doc</span> <span class="pre">indexer</span></code> to extract the original Document‚Äôs binary information.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!Flow</span><span class="w"></span>
<span class="w">  </span><span class="nt">encoder</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BaseEncoder</span><span class="w"></span>
<span class="w">  </span><span class="nt">chunk_indexer</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CompoundIndexer</span><span class="w"></span>
<span class="w">  </span><span class="nt">ranker</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Chunk2DocRanker</span><span class="w"></span>
<span class="w">  </span><span class="nt">doc_indexer</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BinaryPbIndexer</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="switch-vector-indexer-at-query-time">
<h2>Switch Vector Indexer at Query Time<a class="headerlink" href="#switch-vector-indexer-at-query-time" title="Permalink to this heading">#</a></h2>
<p>Jina lets you decide which kind of vector index to use when exposing the system to be queried. Almost all of Jina‚Äôs advanced vector indexers inherit from <code class="docutils literal notranslate"><span class="pre">BaseNumpyIndexer</span></code>. These classes only override methods related to querying the index, but not the ones related to storing vectors, meaning they all store vectors in the same format. Jina takes advantage of this, and has the flexibility to offer the same vector data in different vector indexer types. To implement this functionality there are two things to consider, one for indexing and one for querying.</p>
<section id="indexing">
<h3>Indexing<a class="headerlink" href="#indexing" title="Permalink to this heading">#</a></h3>
<p>At index time, we use <code class="docutils literal notranslate"><span class="pre">NumpyIndexer</span></code>. It is important that the <code class="docutils literal notranslate"><span class="pre">Pod</span></code> containing this Executor ensures <code class="docutils literal notranslate"><span class="pre">read_only:</span> <span class="pre">False</span></code>. This way, the same indexer can be reconstructed from binary form, which contains information of the vectors (dimensions, ‚Ä¶) that are needed to have it work at query time.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!NumpyIndexer</span><span class="w"></span>
<span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;vec.gz&#39;</span><span class="w"></span>
<span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wrapidx</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="querying">
<h3>Querying<a class="headerlink" href="#querying" title="Permalink to this heading">#</a></h3>
<p>At query time, we use <code class="docutils literal notranslate"><span class="pre">NumpyIndexer</span></code> as <code class="docutils literal notranslate"><span class="pre">ref_indexer</span></code> for any advanced indexer inheriting from <code class="docutils literal notranslate"><span class="pre">BaseNumpyIndexer</span></code> (see <code class="docutils literal notranslate"><span class="pre">AnnoyIndexer</span></code>, <code class="docutils literal notranslate"><span class="pre">FaissIndexer</span></code>, ‚Ä¶).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!FaissIndexer</span><span class="w"></span>
<span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">ref_indexer</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">!NumpyIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wrapidx</span><span class="w"></span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;vec.gz&#39;</span><span class="w"></span>
</pre></div>
</div>
<p>In this case, this construction lets the <code class="docutils literal notranslate"><span class="pre">FaissIndexer</span></code> use the <code class="docutils literal notranslate"><span class="pre">vectors</span></code> stored by the indexer named <code class="docutils literal notranslate"><span class="pre">wrapidx</span></code>.</p>
</section>
</section>
<section id="override-parameters-using-queryset">
<h2>Override parameters using QuerySet<a class="headerlink" href="#override-parameters-using-queryset" title="Permalink to this heading">#</a></h2>
<p>We can override parameter values in flows with the help of <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>. <code class="docutils literal notranslate"><span class="pre">querySet</span></code> is a set of <code class="docutils literal notranslate"><span class="pre">QueryLang</span></code> protobuf messages that can be sent along with any <code class="docutils literal notranslate"><span class="pre">Request</span></code>. It is useful to dynamically override parameters of a driver for a specific request. (Not every parameter is able to be overriden)</p>
<p>This <code class="docutils literal notranslate"><span class="pre">QueryLang</span></code> has 3 main fields:</p>
<ul class="simple">
<li><p>name: A name of the driver that will be overriden (the exact class name). For now any driver in the Flow of this class will be affected by this <code class="docutils literal notranslate"><span class="pre">QueryLang</span></code></p></li>
<li><p>parameters: A key-value map where the key is the parameter to be overriden and the value the value that it will be used in the request</p></li>
<li><p>priority: The priority this <code class="docutils literal notranslate"><span class="pre">QueryLang</span></code> has with respect to potential defaults of the driver.</p></li>
</ul>
<p>For a driver to be able to override its parameters and read from the <code class="docutils literal notranslate"><span class="pre">QueryLang</span></code> messages it needs to do 2 things:</p>
<ul class="simple">
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">QuerySetReader</span></code> as a <code class="docutils literal notranslate"><span class="pre">mix-in</span></code> class</p></li>
<li><p>Declare the attribute with an underscore prefix, i.e (<code class="docutils literal notranslate"><span class="pre">self._top_k</span></code> to have <code class="docutils literal notranslate"><span class="pre">top_k</span></code> as an attribute with the potential to be overriden)</p></li>
</ul>
<p>Suppose we want to override <code class="docutils literal notranslate"><span class="pre">VectorSearchDriver's</span></code> top_k value of 10 with 20 in the below pod. We can see that <code class="docutils literal notranslate"><span class="pre">VectorSearchDriver</span></code> fullfills the requirements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VectorSearchDriver</span><span class="p">(</span><span class="n">QuerySetReader</span><span class="p">,</span> <span class="n">BaseSearchDriver</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fill_embedding</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top_k</span> <span class="o">=</span> <span class="n">top_k</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>The pod is defined as taking 10 for its <code class="docutils literal notranslate"><span class="pre">top_k</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">VectorSearchDriver</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!CompoundIndexer</span><span class="w"></span>
<span class="nt">components</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!NumpyIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vec.gz</span><span class="w"></span>
<span class="w">      </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cosine</span><span class="w"></span>
<span class="w">    </span><span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vecidx</span><span class="w"></span>
<span class="w">      </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$JINA_DIR</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!BinaryPbIndexer</span><span class="w"></span>
<span class="w">    </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">index_filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">doc.gz</span><span class="w"></span>
<span class="w">    </span><span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docidx</span><span class="w"></span>
<span class="w">      </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$JINA_DIR</span><span class="w"></span>
<span class="nt">metas</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chunk_indexer</span><span class="w"></span>
<span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$JINA_DIR</span><span class="w"></span>
<span class="nt">requests</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">on</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">IndexRequest</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!VectorIndexDriver</span><span class="w"></span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">executor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vecidx</span><span class="w"></span>
<span class="w">          </span><span class="nt">traversal_paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;r&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!KVIndexDriver</span><span class="w"></span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">executor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docidx</span><span class="w"></span>
<span class="w">          </span><span class="nt">traversal_paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;r&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">[</span><span class="nv">SearchRequest</span><span class="p p-Indicator">]:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!VectorSearchDriver</span><span class="w"></span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">executor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vecidx</span><span class="w"></span>
<span class="w">          </span><span class="nt">top_k</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">          </span><span class="nt">traversal_paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;r&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!KVSearchDriver</span><span class="w"></span>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">executor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docidx</span><span class="w"></span>
<span class="w">          </span><span class="nt">traversal_paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;m&#39;</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
<p>We construct a queryset <code class="docutils literal notranslate"><span class="pre">top_k_queryset</span></code> which defines to use a top_k value of 20 for <code class="docutils literal notranslate"><span class="pre">VectorSearchDriver</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">top_k_queryset</span> <span class="o">=</span> <span class="n">jina_pb2</span><span class="o">.</span><span class="n">QueryLang</span><span class="p">()</span>
    <span class="n">top_k_queryset</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;VectorSearchDriver&#39;</span>
    <span class="n">top_k_queryset</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">top_k_queryset</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;top_k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
<p>Passing <code class="docutils literal notranslate"><span class="pre">top_k_queryset</span></code> to <code class="docutils literal notranslate"><span class="pre">flow.search</span></code> will override <code class="docutils literal notranslate"><span class="pre">top_k</span></code> value of <code class="docutils literal notranslate"><span class="pre">10</span></code> with <code class="docutils literal notranslate"><span class="pre">20</span></code> in the <code class="docutils literal notranslate"><span class="pre">VectorSearchDriver</span></code>.
Note that more than one <code class="docutils literal notranslate"><span class="pre">queryset</span></code> can be passed with any request.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">with</span> <span class="n">Flow</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;flow.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">search_flow</span><span class="p">:</span>
        <span class="n">search_flow</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">input_fn</span><span class="o">=</span><span class="n">docs</span><span class="p">,</span> <span class="n">output_fn</span><span class="o">=</span><span class="n">print_results</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="p">[</span><span class="n">top_k_queryset</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="the-score-field">
<h2>The Score Field<a class="headerlink" href="#the-score-field" title="Permalink to this heading">#</a></h2>
<p>In ranking document matches, Jina uses several algorithms to compute the <em>relevance</em> of a document given a specific query. This is stored as a numeric value in the <code class="docutils literal notranslate"><span class="pre">score</span></code> field of a <code class="docutils literal notranslate"><span class="pre">match</span></code>, both at a <code class="docutils literal notranslate"><span class="pre">document</span></code> level and at the <code class="docutils literal notranslate"><span class="pre">chunk</span></code> level. This field can mean either ‚Äúsmaller is better‚Äù (<em>distance</em>) or ‚Äúlarger is better‚Äù (<em>similarity</em>, <em>relevance</em>).</p>
<p>As, an example, the <code class="docutils literal notranslate"><span class="pre">NumpyIndexer</span></code> uses k-NN (with various distance metrics) to calculate a <em>distance</em>, thus ‚Äúsmaller is better‚Äù. On the other hand, the <code class="docutils literal notranslate"><span class="pre">MinRanker</span></code> uses the function <em>1/(1+s)</em> (where <em>s</em> is the min. score from all <code class="docutils literal notranslate"><span class="pre">chunks</span></code>) in order to ‚Äúbubble up‚Äù the score from child <code class="docutils literal notranslate"><span class="pre">chunks</span></code> to the parent, thus ‚Äúlarger is better‚Äù. There can be other metrics too.</p>
<p>This can pe problematic when deciding how to sort the results from a query. Fortunately, Jina provides the name of the operator that has performed the scoring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/**
 * Represents the relevance model to `ref_id`
 */
message NamedScore {
    float value = 1; // value
    string op_name = 2; // the name of the operator/score function
    ...
}
</pre></div>
</div>
<p>Notice the field <code class="docutils literal notranslate"><span class="pre">op_name</span></code> in the above. As the comment suggests, this is the name of the operator that has performed the sorting (e.g. <code class="docutils literal notranslate"><span class="pre">NumpyIndexer</span></code>, or <code class="docutils literal notranslate"><span class="pre">MinRanker</span></code>). Based on this, the <code class="docutils literal notranslate"><span class="pre">value</span></code> field is either of type ‚Äúsmaller is better‚Äù or of type ‚Äúlarger is better‚Äù.</p>
<p><strong>Conclusion</strong>: When sorting results, make sure you check the <code class="docutils literal notranslate"><span class="pre">document.score.op_name</span></code> in order to understand the direction of the score.</p>
</section>
</section>

                </article>
            </div>
            <footer>
                
                <div class="related-pages">
                    <a class="next-page" href="../../cross-multi-modality/">
                        <div class="page-info">
                            <div class="context">
                                <span>Next</span>
                            </div>
                            <div class="title">Multi &amp; Cross Modality</div>
                        </div>
                        <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
                    </a>
                    <a class="prev-page" href="../../traversal/">
                        <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
                        <div class="page-info">
                            <div class="context">
                                <span>Previous</span>
                            </div>
                            
                            <div class="title">Understand Jina Recursive Document Representation</div>
                            
                        </div>
                    </a>
                </div>
                <div class="bottom-of-page">
                    <div class="left-details">
                        <div class="copyright">
                            Copyright &#169; Jina AI Limited. All rights reserved.
                        </div><div class="last-updated">
                            Last updated on Oct 19, 2022</div>
                    </div>
                    <div class="right-details">
                        <div class="social-btns">
                            <a class='social-btn' href="https://github.com/jina-ai/jina" aria-label="GitHub"
                               target="_blank" rel="noreferrer"> <i class="fab fa-github"></i></a>
                            <a class='social-btn' href="https://slack.jina.ai" aria-label="Slack" target="_blank"
                               rel="noreferrer"> <i class="fab fa-slack"></i></a>
                            <a class='social-btn' href="https://youtube.com/c/jina-ai" aria-label="YouTube"
                               target="_blank" rel="noreferrer"> <i class="fab fa-youtube"></i></a>
                            <a class='social-btn' href="https://twitter.com/JinaAI_" aria-label="Twitter"
                               target="_blank" rel="noreferrer"> <i class="fab fa-twitter"></i></a>
                            <a class='social-btn' href="https://www.linkedin.com/company/jinaai/" aria-label="LinkedIn"
                               target="_blank" rel="noreferrer"> <i class="fab fa-linkedin"></i></a>
                        </div>
                    </div>
                </div>
                
            </footer>
        </div>
        <aside class="toc-drawer">
            
            
            <div class="toc-sticky toc-scroll">
                <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
<li><a class="reference internal" href="#">Common Design Patterns</a><ul>
<li><a class="reference internal" href="#compoundindexer-vector-kv-indexers">CompoundIndexer (Vector + KV Indexers)</a></li>
<li><a class="reference internal" href="#text-document-segmentation">Text Document Segmentation</a></li>
<li><a class="reference internal" href="#indexers-at-different-depth-levels">Indexers at Different Depth Levels</a></li>
<li><a class="reference internal" href="#switch-vector-indexer-at-query-time">Switch Vector Indexer at Query Time</a><ul>
<li><a class="reference internal" href="#indexing">Indexing</a></li>
<li><a class="reference internal" href="#querying">Querying</a></li>
</ul>
</li>
<li><a class="reference internal" href="#override-parameters-using-queryset">Override parameters using QuerySet</a></li>
<li><a class="reference internal" href="#the-score-field">The Score Field</a></li>
</ul>
</li>
</ul>

                    </div>
                </div>
            </div>
            
            
        </aside>
    </div>
    <qa-bot
            title="Jina Bot"
            description="Build cross-modal and multi-modal applications on the cloud"
    >
        <template>
            <dl>
                <dt>You can ask questions about our docs. Try:</dt>
                <dd>Does Jina support Kubernetes?</dd>
                <dd>What are the basic concepts in Jina?</dd>
                <dd>How to share my Executor?</dd>
            </dl>
        </template>
    </qa-bot>
</div>
<img referrerpolicy="no-referrer-when-downgrade"
     src="https://static.scarf.sh/a.png?x-pxid=2823e771-0e1e-4320-8fde-48bc48e53262"/><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() { 
            document.querySelector('qa-bot').setAttribute('server', 'https://jina-ai-jina.docsqa.jina.ai');
        });
        </script>
    <script src="https://cdn.jsdelivr.net/npm/qabot@0.4"></script>
    </body>
</html>